# STEPS
# setup a variable for your container that contains blank scrolls, pen and inks and cloth named: 
# restock_container
# make sure you have active counters for cloth and blank scrolls under Display/Counters and that they are check marked

if not findtype "pen and ink" backpack or count 'blankscrolls' < 10 or count 'cloth' < 10
    restock 4
    wft 
    target 'restock_container'
    wait 600
endif

if not findtype "blank scroll%s%" backpack
    overhead 'Out of scrolls' 34
    replay
endif

if not findtype "pen and ink" backpack
    overhead 'Out of ink' 34
    replay
endif

clearsysmsg 

if skill 'Inscription' >= 120
    overhead 'Hit max!' 88
    wait 4500
    replay
endif

gumpclose
if skill 'Inscription' < 60
    overhead '50 - 60: Magic Reflect'
    dclicktype "pen and ink" backpack
    waitforgump 949095101
    gumpresponse 108
    waitforgump 949095101
    gumpresponse 203
    waitforgump 949095101
    wait 3000
elseif skill 'Inscription' < 80
    overhead '60 - 80: Energy Bolt'
    dclicktype "pen and ink" backpack
    waitforgump 949095101
    gumpresponse 109
    waitforgump 949095101
    gumpresponse 201
    waitforgump 949095101
    wait 3000
elseif skill 'Inscription' < 100
    overhead '80 - 100: Spellbooks'
    dclicktype "pen and ink" backpack
    waitforgump 949095101
    gumpresponse 100
    waitforgump 949095101
    gumpresponse 200
    waitforgump 949095101
    wait 3000
elseif skill 'Inscription' < 120
    overhead "100 - 120: Magical Wizard's Hat"
    dclicktype "pen and ink" backpack
    waitforgump 949095101
    gumpresponse 102
    waitforgump 949095101
    gumpresponse 200
    waitforgump 949095101
    wait 3000
else
    overhead 'We did it!'
endif

    
if findtype "pen and ink" backpack
    
    if findtype "Magic Reflection S" backpack
        gumpclose 
        overhead 'Recycle!' 88
        dclicktype "pen and ink" backpack
        waitforgump 949095101
        gumpresponse 3
        waitfortarget 
        targettype "Magic Reflection S" backpack
        wait 2000
    endif
    
    if findtype "Energy Bolt Scroll" backpack
        gumpclose 
        overhead 'Recycle!' 88
        dclicktype "pen and ink" backpack
        waitforgump 949095101
        gumpresponse 3
        waitfortarget 
        targettype "Energy Bolt Scroll" backpack
        wait 2000
    endif
    
    
    if findtype "spellbook" backpack
        gumpclose 
        overhead 'Recycle!' 88
        dclicktype "pen and ink" backpack
        waitforgump 949095101
        gumpresponse 3
        waitfortarget 
        targettype "spellbook" backpack
        wait 2000
    endif
    
    if findtype "wizard's hat" backpack and findtype "scissors" backpack
        gumpclose 
        overhead 'Recycle!' 88
        dclicktype "scissors" backpack
        waitfortarget 
        targettype "wizard's hat" backpack
        wait 2000
    endif
endif
loop